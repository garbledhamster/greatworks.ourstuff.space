<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>Great Books Compass</title>
  <meta name="description" content="A static, idea-driven compass for Great Books of the Western World. Search by feeling or idea, get a clear reading pick with reasons." />

  <!-- Tailwind CDN (GitHub Pages friendly) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['ui-sans-serif', 'system-ui', 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', 'Apple Color Emoji', 'Segoe UI Emoji']
          },
          boxShadow: {
            soft: '0 10px 30px rgba(0,0,0,.18)'
          }
        }
      }
    }
  </script>

  <style>
    /* Small “HTML5UP-ish” touches */
    .grain {
      background-image:
        radial-gradient(circle at 25% 10%, rgba(255,255,255,.08), transparent 35%),
        radial-gradient(circle at 80% 30%, rgba(255,255,255,.06), transparent 40%),
        radial-gradient(circle at 15% 85%, rgba(255,255,255,.05), transparent 40%),
        linear-gradient(180deg, rgba(255,255,255,.06), transparent 35%),
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.18'/%3E%3C/svg%3E");
      background-blend-mode: screen, screen, screen, normal, overlay;
    }
    .fade-mask {
      -webkit-mask-image: linear-gradient(to bottom, black 70%, transparent 100%);
      mask-image: linear-gradient(to bottom, black 70%, transparent 100%);
    }
    .focus-ring:focus { outline: none; box-shadow: 0 0 0 4px rgba(99,102,241,.35); }
    .kbd { border: 1px solid rgba(255,255,255,.18); }
    html { scroll-behavior: smooth; }
  </style>
</head>

<body class="min-h-screen bg-zinc-950 text-zinc-100 font-sans">
  <!-- Top gradient / hero background -->
  <div class="relative overflow-hidden">
    <div class="absolute inset-0 grain opacity-80"></div>
    <div class="absolute -top-28 -left-28 h-96 w-96 rounded-full blur-3xl opacity-40"
         style="background: radial-gradient(circle at 30% 30%, #6366f1, transparent 60%);"></div>
    <div class="absolute -top-24 -right-28 h-96 w-96 rounded-full blur-3xl opacity-35"
         style="background: radial-gradient(circle at 40% 40%, #22c55e, transparent 60%);"></div>

    <header class="relative z-10 mx-auto max-w-6xl px-5 pt-6">
      <div class="flex items-center justify-between gap-4">
        <div class="flex items-center gap-3">
          <div class="h-10 w-10 rounded-xl bg-white/10 ring-1 ring-white/15 shadow-soft grid place-items-center">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="opacity-90">
              <path d="M4 5.5C4 4.12 5.12 3 6.5 3H20v16H7.2c-1.77 0-3.2 1.43-3.2 3.2V5.5Z" stroke="currentColor" stroke-width="1.7"/>
              <path d="M20 19v2H7.2C5.43 21 4 19.57 4 17.8" stroke="currentColor" stroke-width="1.7"/>
              <path d="M8 7h8M8 10h7M8 13h5" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
            </svg>
          </div>
          <div>
            <div class="text-lg font-semibold tracking-tight">Great Books Compass</div>
            <div class="text-xs text-zinc-300/80">Static • GitHub Pages • Feeling → Idea → Book</div>
          </div>
        </div>

        <div class="flex items-center gap-2">
          <a href="#library" class="text-sm px-3 py-2 rounded-lg bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition">Library</a>
          <button id="btnExport"
            class="text-sm px-3 py-2 rounded-lg bg-indigo-500/90 hover:bg-indigo-500 ring-1 ring-indigo-300/30 shadow-soft transition">
            Export book files
          </button>
        </div>
      </div>

      <div class="mt-10 pb-12">
        <h1 class="text-3xl sm:text-4xl font-semibold tracking-tight leading-tight">
          Find the <span class="text-indigo-300">right Great Book</span> for what you’re feeling.
        </h1>
        <p class="mt-3 text-zinc-200/80 max-w-2xl">
          Type a feeling, a problem, or an idea. The compass maps your words to themes,
          then ranks GBWW volumes with transparent reasons.
        </p>

        <!-- Mode switch -->
        <div class="mt-6 flex flex-wrap items-center gap-2">
          <button id="tabCompass"
            class="px-4 py-2 rounded-xl bg-white/10 hover:bg-white/15 ring-1 ring-white/15 transition text-sm">
            Compass Mode
          </button>
          <button id="tabBrowse"
            class="px-4 py-2 rounded-xl bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition text-sm">
            Browse Mode
          </button>

          <div class="ml-auto hidden sm:flex items-center gap-2 text-xs text-zinc-300/80">
            <span class="kbd px-2 py-1 rounded-lg bg-white/5">Ctrl</span>+
            <span class="kbd px-2 py-1 rounded-lg bg-white/5">K</span>
            <span class="ml-1">to focus search</span>
          </div>
        </div>

        <!-- Search card -->
        <div class="mt-4 rounded-2xl bg-white/5 ring-1 ring-white/10 shadow-soft overflow-hidden">
          <div class="p-4 sm:p-5">
            <label class="block text-xs text-zinc-300/80 mb-2" for="q">
              What’s on your mind?
            </label>
            <div class="flex flex-col sm:flex-row gap-3">
              <div class="flex-1">
                <input id="q" class="w-full focus-ring rounded-xl bg-zinc-950/60 ring-1 ring-white/10 px-4 py-3 text-base placeholder:text-zinc-500"
                  placeholder='e.g. "I feel sick and don’t want to do anything" or "I need courage" or "what is justice?"' />
                <div class="mt-2 text-xs text-zinc-400/80">
                  Tip: try <span class="text-zinc-200">“I’m anxious”</span>, <span class="text-zinc-200">“I feel directionless”</span>,
                  <span class="text-zinc-200">“I need motivation”</span>, <span class="text-zinc-200">“I’m grieving”</span>.
                </div>
              </div>

              <div class="flex gap-2">
                <button id="btnGo"
                  class="px-4 py-3 rounded-xl bg-indigo-500/90 hover:bg-indigo-500 ring-1 ring-indigo-300/30 shadow-soft transition text-sm font-medium">
                  Find me a book
                </button>
                <button id="btnClear"
                  class="px-4 py-3 rounded-xl bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition text-sm">
                  Clear
                </button>
              </div>
            </div>

            <div id="chips" class="mt-4 flex flex-wrap gap-2"></div>
          </div>
        </div>
      </div>
    </header>
  </div>

  <!-- Main -->
  <main class="relative z-10 mx-auto max-w-6xl px-5 pb-16">
    <!-- Compass results -->
    <section id="compassSection" class="mt-6 grid lg:grid-cols-3 gap-5">
      <div class="lg:col-span-2">
        <div class="flex items-center justify-between">
          <h2 class="text-lg font-semibold">Recommendations</h2>
          <div class="text-xs text-zinc-400/80">
            Transparent scoring • no AI calls • all client-side
          </div>
        </div>

        <div id="results" class="mt-3 space-y-3"></div>

        <div id="emptyState" class="mt-4 rounded-2xl bg-white/4 ring-1 ring-white/10 p-6 text-zinc-200/80">
          <div class="text-sm">
            Type something above and hit <span class="text-zinc-100 font-medium">Find me a book</span>.
            You’ll see top matches and the exact reasons.
          </div>
        </div>
      </div>

      <aside class="lg:col-span-1">
        <div class="rounded-2xl bg-white/4 ring-1 ring-white/10 p-5 shadow-soft">
          <div class="flex items-center justify-between">
            <h3 class="text-sm font-semibold">Why these picks</h3>
            <button id="btnExplain"
              class="text-xs px-2 py-1 rounded-lg bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition">
              Toggle details
            </button>
          </div>

          <div id="explain" class="mt-3 text-sm text-zinc-200/80 space-y-4">
            <div>
              <div class="text-xs uppercase tracking-wide text-zinc-400">Signals</div>
              <div id="signalList" class="mt-2 text-sm"></div>
            </div>
            <div>
              <div class="text-xs uppercase tracking-wide text-zinc-400">How scoring works</div>
              <ul class="mt-2 text-sm list-disc pl-5 space-y-1 text-zinc-200/75">
                <li>Your words map to <span class="text-zinc-100">themes</span> and <span class="text-zinc-100">moods</span>.</li>
                <li>Each book has tags; overlaps add points. Short/accessible works get a bump when you sound tired/sick.</li>
                <li>You’ll see matched tags on each recommendation card.</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="mt-5 rounded-2xl bg-white/4 ring-1 ring-white/10 p-5 shadow-soft">
          <h3 class="text-sm font-semibold">Your shelf</h3>
          <div class="mt-2 text-xs text-zinc-400/80">Star books to save them here (stored in localStorage).</div>
          <div id="shelf" class="mt-3 space-y-2"></div>
        </div>
      </aside>
    </section>

    <!-- Library -->
    <section id="library" class="mt-16">
      <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3">
        <div>
          <h2 class="text-2xl font-semibold tracking-tight">Library</h2>
          <p class="mt-1 text-sm text-zinc-300/80">All GBWW (1990) volumes, with tags you can extend over time.</p>
        </div>

        <div class="flex gap-2">
          <input id="librarySearch"
            class="w-full sm:w-80 focus-ring rounded-xl bg-white/5 ring-1 ring-white/10 px-4 py-2 text-sm placeholder:text-zinc-500"
            placeholder="Search title, author, work, tag…" />
          <button id="btnResetFilters"
            class="px-3 py-2 rounded-xl bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition text-sm">
            Reset
          </button>
        </div>
      </div>

      <div class="mt-4 flex flex-wrap gap-2">
        <div class="text-xs text-zinc-400/80 mr-2">Quick filters:</div>
        <button data-filter="short" class="filterBtn px-3 py-1.5 rounded-xl bg-white/5 hover:bg-white/10 ring-1 ring-white/10 text-xs transition">Short-ish</button>
        <button data-filter="fiction" class="filterBtn px-3 py-1.5 rounded-xl bg-white/5 hover:bg-white/10 ring-1 ring-white/10 text-xs transition">Imaginative</button>
        <button data-filter="philosophy" class="filterBtn px-3 py-1.5 rounded-xl bg-white/5 hover:bg-white/10 ring-1 ring-white/10 text-xs transition">Philosophy</button>
        <button data-filter="science" class="filterBtn px-3 py-1.5 rounded-xl bg-white/5 hover:bg-white/10 ring-1 ring-white/10 text-xs transition">Science</button>
        <button data-filter="comfort" class="filterBtn px-3 py-1.5 rounded-xl bg-white/5 hover:bg-white/10 ring-1 ring-white/10 text-xs transition">Comforting</button>
      </div>

      <div id="libraryGrid" class="mt-5 grid sm:grid-cols-2 lg:grid-cols-3 gap-3"></div>
    </section>
  </main>

  <!-- Book detail modal -->
  <div id="modal" class="fixed inset-0 z-50 hidden">
    <div id="modalOverlay" class="absolute inset-0 bg-black/70"></div>
    <div class="absolute inset-0 grid place-items-center p-4">
      <div class="w-full max-w-2xl rounded-2xl bg-zinc-950 ring-1 ring-white/15 shadow-soft overflow-hidden">
        <div class="p-4 sm:p-5 flex items-start justify-between gap-3">
          <div>
            <div id="modalTitle" class="text-lg font-semibold"></div>
            <div id="modalMeta" class="mt-1 text-sm text-zinc-300/80"></div>
          </div>
          <button id="modalClose"
            class="px-3 py-2 rounded-xl bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition text-sm">
            Close
          </button>
        </div>
        <div class="px-4 sm:px-5 pb-5">
          <div id="modalBody" class="text-sm text-zinc-200/85 space-y-3"></div>
          <div class="mt-4 flex flex-wrap gap-2">
            <a id="modalOpenFile" href="#" target="_blank" rel="noopener"
               class="px-3 py-2 rounded-xl bg-indigo-500/90 hover:bg-indigo-500 ring-1 ring-indigo-300/30 shadow-soft transition text-sm font-medium">
              Open book file
            </a>
            <button id="modalStar"
              class="px-3 py-2 rounded-xl bg-white/5 hover:bg-white/10 ring-1 ring-white/10 transition text-sm">
              Star / Unstar
            </button>
          </div>
          <div class="mt-3 text-xs text-zinc-500">
            “Open book file” points to <code class="text-zinc-300">books/&lt;slug&gt;.html</code>. Use <b>Export book files</b> to generate them.
          </div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="js/main.js"></script>
</body>
</html>
